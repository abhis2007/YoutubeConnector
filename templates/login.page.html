{{template "base" .}}
{{define "css"}}
<style>
    </style>
{{end}}

{{define "Title"}}
<title>Login Page</title>
{{end}}

{{define "content"}}
<div class="row">
    <div class="col-sm-1 col-md-2 col-lg-2"></div>
    <div class="col-sm-10 col-md-6 col-lg-6">
        <span id="errorBox"></span>
        <form id="signupData">
            <div class="form-group">
                <label for="userId">User Id</label>
                <input type="text" class="form-control"
                    id="userId" name="userId"
                    placeholder="Enter user name">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control"
                    id="password" name="password"
                    placeholder="Password">
            </div>
            <button type="submit"
                class="btn btn-primary">Submit</button>
            <a href="/signUp">Create a new account</a>
        </form>
    </div>
</div>
{{end}}

{{define "js"}}
<script>
    var errBx = document.getElementById("errorBox");
    var form = document.getElementById("signupData");
    form.addEventListener("submit", function(event){
        event.preventDefault() ;
        if( validateData() ){
            processOnServer() ;
        }
    })
    function validateData() {
        var userId = form["userId"].value;
        if (userId.trim() === '') {
            errBx.innerText = "User id is empty.";
            return false;
        }

        var pwd = form["password"].value;

        if (pwd.length <= 6) {
            errBx.innerText = "Password length is less than or equal to 6.";
            return false;
        }
        return true ; 
   }

    function processOnServer(){
        var formData = new FormData(form);
        fetch("/LoginData", {
            method: "POST",        
            body: formData
        })
        .then(response=>{
            if( !response.ok ){
                return response.text().then(errorMessage => {
                    throw new Error(errorMessage);
                });
            }
            return response.text();
        })
        .then(data=>{
            console.log(data)
            errBx.innerText = data ;
            //give a small flasj screen

            //window.location.replace("/");
        })
        .catch(error=>{
            errBx.innerText = error.message ;                
        })
    }

</script>
{{end}}